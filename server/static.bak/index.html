<!doctype html>
<html lang="en" class="sl-theme-dark">

  <head>
    <title>This is nice</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.17.1/cdn/themes/dark.css" />
    <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.17.1/cdn/shoelace-autoloader.js"></script>
    <link rel="stylesheet" href="static/css/main.css" />
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  </head>

  <body x-data="router()">
    <div class="container" x-data="dragAndDrop()">

      <!-- <div x-data="$store.clients" class="clients"> -->
      <div x-data="clients()" class="clients">
        <template x-for="client in $store.clients.data">
          <div class="client" 
            :class="{'highlight': client.id == hoveredClientId}"
            :data-client-id="client.id" 
            @dragenter="dragEnter(client.id)" 
            @dragleave="dragLeave"
            @dragover.prevent 
            @drop="dropWallpaper($event)">

            <div>
              <template x-if="client.wallpaper_code">
                <img :src="`/wallpapers/thumbnail/${client.wallpaper_code}`" />
              </template>
              <template x-if="!client.wallpaper_code">
                <img src="/static/images/missing.png" />
              </template>
            </div>

            <div class="action">
              <sl-dropdown style="width:100%;">
                <sl-button size="small" style="width: 100%;" class="clientb" slot="trigger" caret>
                  <sl-icon slot="prefix" name="laptop" :class="{'online': client.connected_at != ''}"></sl-icon>
                  <span x-text="client.hostname"></span>
                </sl-button>
                <sl-menu>
                  <sl-menu-item disabled x-text="client.addr"></sl-menu-item>
                  <sl-divider></sl-divider>
                  <sl-menu-item @click="renameDialog(client.uuid, client.hostname)">
                    Lock 
                    <sl-icon slot="prefix" library="fa" name="far-lock"></sl-icon>
                  </sl-menu-item>
                  <sl-divider></sl-divider>
                  <sl-menu-item @click="renameDialog(client.uuid, client.hostname)">
                    Rename
                    <sl-icon slot="prefix" name="pencil"></sl-icon>
                  </sl-menu-item>
                  <sl-menu-item @click="deleteDialog(client.uuid, client.hostname)">
                    Delete
                    <sl-icon slot="prefix" name="trash3"></sl-icon>
                  </sl-menu-item>
                </sl-menu>
              </sl-dropdown>
            </div>
        </template>
      </div>

      <div>
        <nav>
          <ul><a href="/" @click.prevent="navigate('home', '/')">home</a></ul>
          <ul><a href="/papers" @click.prevent="navigate('papers', '/papers')">papers</a></ul>
        </nav>

        <br /><br />
        <main x-html="pageContent"></main>
      </div>

    </div>

    <div id="drag-thumbnail">
        <img id="drag-thumbnail-image">
    </div>

    <sl-dialog label="Rename client" class="dialog-overview" id="dialog-rename">
      <sl-input></sl-input>
      <sl-button slot="footer" variant="primary">Rename</sl-button>
    </sl-dialog>

    <sl-dialog label="Delete client" class="dialog-overview" id="dialog-delete">
      Are you sure you want to delete <span></span>?
      <sl-button slot="footer" variant="danger">Delete</sl-button>
    </sl-dialog>
    <script src="static/js/main.js"></script>
  </body>

</html>
